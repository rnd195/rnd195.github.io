<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Řanda">
<meta name="dcterms.date" content="2025-05-05">

<title>A Beginner’s Guide to pandas &amp; polars – rnd195</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<!--<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script> -->
<script src="../../site_libs/quarto-nav/quarto-nav.js"></script><script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../../img/logo_icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-663f72ce8d3f6f9723369319aa60f184.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-696d242389863c368558089dc05d5721.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!--<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script> -->



<!--<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script> -->



<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../img/logo_fade.svg" alt="" class="navbar-logo light-content">
    <img src="../../img/logo_fade.svg" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">rnd195</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contact" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contact</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contact">    
        <li>
    <a class="dropdown-item" href="mailto:contact@rnd195.anonaddy.com">
 <span class="dropdown-text">E-mail</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/rnd195" target="_blank">
 <span class="dropdown-text">GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/martin-randa/" target="_blank">
 <span class="dropdown-text">LinkedIn</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A Beginner’s Guide to pandas &amp; polars</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Martin Řanda </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 5, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#take-a-peek" id="toc-take-a-peek" class="nav-link" data-scroll-target="#take-a-peek">Take a peek</a></li>
  <li><a href="#subset-a-dataframe" id="toc-subset-a-dataframe" class="nav-link" data-scroll-target="#subset-a-dataframe">Subset a DataFrame</a>
  <ul class="collapse">
  <li><a href="#columns" id="toc-columns" class="nav-link" data-scroll-target="#columns">Columns</a></li>
  <li><a href="#rows" id="toc-rows" class="nav-link" data-scroll-target="#rows">Rows</a></li>
  </ul></li>
  <li><a href="#creating-new-columns" id="toc-creating-new-columns" class="nav-link" data-scroll-target="#creating-new-columns">Creating new columns</a></li>
  <li><a href="#boolean-filters" id="toc-boolean-filters" class="nav-link" data-scroll-target="#boolean-filters">Boolean filters</a></li>
  <li><a href="#replacing-values-in-row-slices" id="toc-replacing-values-in-row-slices" class="nav-link" data-scroll-target="#replacing-values-in-row-slices">Replacing values in row slices</a></li>
  <li><a href="#create-a-copy" id="toc-create-a-copy" class="nav-link" data-scroll-target="#create-a-copy">Create a copy</a></li>
  <li><a href="#joining-data" id="toc-joining-data" class="nav-link" data-scroll-target="#joining-data">Joining data</a>
  <ul class="collapse">
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join">Inner join</a></li>
  <li><a href="#concatenate-by-rows" id="toc-concatenate-by-rows" class="nav-link" data-scroll-target="#concatenate-by-rows">Concatenate by rows</a></li>
  </ul></li>
  <li><a href="#quick-plotting" id="toc-quick-plotting" class="nav-link" data-scroll-target="#quick-plotting">Quick plotting</a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a>
  <ul class="collapse">
  <li><a href="#create-a-range-of-dates" id="toc-create-a-range-of-dates" class="nav-link" data-scroll-target="#create-a-range-of-dates">Create a range of dates</a></li>
  <li><a href="#subset-a-specific-time-interval" id="toc-subset-a-specific-time-interval" class="nav-link" data-scroll-target="#subset-a-specific-time-interval">Subset a specific time interval</a></li>
  <li><a href="#resampling" id="toc-resampling" class="nav-link" data-scroll-target="#resampling">Resampling</a></li>
  <li><a href="#group-by-time-intervals" id="toc-group-by-time-intervals" class="nav-link" data-scroll-target="#group-by-time-intervals">Group by time intervals</a></li>
  </ul></li>
  <li><a href="#saving-data" id="toc-saving-data" class="nav-link" data-scroll-target="#saving-data">Saving data</a></li>
  <li><a href="#sources-and-further-reading" id="toc-sources-and-further-reading" class="nav-link" data-scroll-target="#sources-and-further-reading">Sources and further reading</a></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://github.com/rnd195/rnd195.github.io-comments/issues/3" target="_blank"><i class="bi bi-chat"></i>Comment on GitHub</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This guide will help you start learning <code>polars</code> by showcasing analogous code snippets from <code>pandas</code>.</p>
<p><img src="thumbnail.png" class="img-fluid" alt="Picture of text that says import pandas as pd and import polars as pl"></p>
<p>In recent years, <code>polars</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is becoming increasingly popular in the data science community (more than 33k stars on GitHub as of May 2025<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>). According to the author of <code>polars</code>, Ritchie Vink, the package’s API is “consistent and strict,” and its focus is on maximizing single machine performance<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> which perhaps explains some of the library’s appeal. From my experience, <code>polars</code> has been a major time saver, especially in data-intensive computations. However, I think that it is perfectly reasonable to prefer <code>pandas</code> for some tasks (like quick data visualization), and I am glad that this competition is pushing the field forward.</p>
<p>In this post, I wrote down some of the most common operations in <code>pandas</code> and their equivalents in <code>polars</code> to help you get acquainted with the package (and to help myself remember). Please, note that this guide / cheat sheet may not be exhaustive and in some cases, there might be additional ways to achieve the same goal. Feel free to let me know <a href="https://github.com/rnd195/rnd195.github.io-comments/issues/3">in the comments</a>.</p>
<p>This is a runnable Quarto document, so first, let’s load the packages.</p>
<div id="814a78ba" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date, timedelta, datetime</span></code></pre></div>
</div>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load data</h2>
<p>We’ll be working with my Wizard Shop Dataset<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> which was specifically crafted for introductory data analysis. It consists of three tables:</p>
<ul>
<li><p><code>wizard_shop_inventory.csv</code>: A list of products with prices, item quality, and other attributes.</p></li>
<li><p><code>magical_items_info.csv</code>: A small table with typical price, quality, and where the item is typically found.</p></li>
<li><p><code>items_prices_timeline.csv</code>: Average daily prices of each product category.</p></li>
</ul>
<p>Let’s load the data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>As we can see, the syntax is the same in both packages except for parsing dates.</p>
<div id="0228f36f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/rnd195/wizard-shop-dataset/refs/heads/main/data/"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_pd <span class="op">=</span> pd.read_csv(data_url <span class="op">+</span> <span class="st">"wizard_shop_inventory.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>info_pd <span class="op">=</span> pd.read_csv(data_url <span class="op">+</span> <span class="st">"magical_items_info.csv"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>prices_pd <span class="op">=</span> pd.read_csv(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    data_url <span class="op">+</span> <span class="st">"items_prices_timeline.csv"</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>[<span class="st">"date"</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>As we can see, the syntax is the same in both packages except for parsing dates.</p>
<div id="30ca7678" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/rnd195/wizard-shop-dataset/refs/heads/main/data/"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> pl.read_csv(data_url <span class="op">+</span> <span class="st">"wizard_shop_inventory.csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>info_pl <span class="op">=</span> pl.read_csv(data_url <span class="op">+</span> <span class="st">"magical_items_info.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>prices_pl <span class="op">=</span> pl.read_csv(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    data_url <span class="op">+</span> <span class="st">"items_prices_timeline.csv"</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    try_parse_dates<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="take-a-peek" class="level2">
<h2 class="anchored" data-anchor-id="take-a-peek">Take a peek</h2>
<p>Sometimes, we want to take a quick look at the data. The methods <code>.sample()</code>, <code>.head()</code>, and <code>.tail()</code> all work in both packages.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The <code>df</code> DataFrame contains all the products the wizard shopkeeper sells—items like potions, amulets, or cloaks.</p>
<div id="aa5c03cb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_pd.sample(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">magical_power</th>
<th data-quarto-table-cell-role="th">quality</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">found_in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">426</th>
<td>427</td>
<td>cloak</td>
<td>630.5</td>
<td>298.183</td>
<td>0</td>
<td>True</td>
<td>dungeon</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">299</th>
<td>300</td>
<td>staff</td>
<td>2124.0</td>
<td>772.533</td>
<td>7</td>
<td>True</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">42</th>
<td>43</td>
<td>amulet</td>
<td>1076.0</td>
<td>465.399</td>
<td>9</td>
<td>True</td>
<td>dungeon</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>info</code> table contains information about the typical attributes of these items.</p>
<div id="3ef6482f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>info_pd.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">typical_price</th>
<th data-quarto-table-cell-role="th">typical_quality</th>
<th data-quarto-table-cell-role="th">typically_found_in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>amulet</td>
<td>1000</td>
<td>9</td>
<td>dungeon</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>potion</td>
<td>50</td>
<td>7</td>
<td>village</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>cloak</td>
<td>500</td>
<td>4</td>
<td>city</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>prices</code> DataFrame contains the daily average price of each item in the fantasy world’s economy in the magical year of 2025.</p>
<div id="a75ec98a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>prices_pd.tail(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">362</th>
<td>2025-12-29</td>
<td>742.21</td>
<td>44.70</td>
<td>648.72</td>
<td>971.90</td>
<td>731.69</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">363</th>
<td>2025-12-30</td>
<td>802.06</td>
<td>48.99</td>
<td>446.10</td>
<td>1711.04</td>
<td>728.60</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">364</th>
<td>2025-12-31</td>
<td>957.94</td>
<td>64.08</td>
<td>503.88</td>
<td>2899.72</td>
<td>829.59</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>The <code>df</code> DataFrame contains all the products the wizard shopkeeper sells—items like potions, amulets, or cloaks.</p>
<div id="ec1b1fae" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_pl.sample(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 7)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">magical_power</th>
<th data-quarto-table-cell-role="th">quality</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">found_in</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>bool</td>
<td>str</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>376</td>
<td>"scroll"</td>
<td>1039.5</td>
<td>424.913</td>
<td>4</td>
<td>true</td>
<td>"dungeon"</td>
</tr>
<tr class="even">
<td>90</td>
<td>"potion"</td>
<td>64.35</td>
<td>93.7195</td>
<td>3</td>
<td>true</td>
<td>"dungeon"</td>
</tr>
<tr class="odd">
<td>125</td>
<td>"potion"</td>
<td>54.05</td>
<td>108.9175</td>
<td>8</td>
<td>true</td>
<td>"dungeon"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>info</code> table contains information about the typical attributes of these items.</p>
<div id="71c4bfa7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>info_pl.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">typical_price</th>
<th data-quarto-table-cell-role="th">typical_quality</th>
<th data-quarto-table-cell-role="th">typically_found_in</th>
</tr>
<tr class="even">
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"amulet"</td>
<td>1000</td>
<td>9</td>
<td>"dungeon"</td>
</tr>
<tr class="even">
<td>"potion"</td>
<td>50</td>
<td>7</td>
<td>"village"</td>
</tr>
<tr class="odd">
<td>"cloak"</td>
<td>500</td>
<td>4</td>
<td>"city"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>prices</code> DataFrame contains the daily average price of each item in the fantasy world’s economy in the magical year of 2025.</p>
<div id="91f809ba" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>prices_pl.tail(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<td>date</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025-12-29</td>
<td>742.21</td>
<td>44.7</td>
<td>648.72</td>
<td>971.9</td>
<td>731.69</td>
</tr>
<tr class="even">
<td>2025-12-30</td>
<td>802.06</td>
<td>48.99</td>
<td>446.1</td>
<td>1711.04</td>
<td>728.6</td>
</tr>
<tr class="odd">
<td>2025-12-31</td>
<td>957.94</td>
<td>64.08</td>
<td>503.88</td>
<td>2899.72</td>
<td>829.59</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="subset-a-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="subset-a-dataframe">Subset a DataFrame</h2>
<section id="columns" class="level3">
<h3 class="anchored" data-anchor-id="columns">Columns</h3>
<section id="select-a-column-by-name" class="level4">
<h4 class="anchored" data-anchor-id="select-a-column-by-name">Select a column by name</h4>
<p>There are several ways to select a single column in both <code>pandas</code> and <code>polars</code>. Note that some of the calls return a Series while others return a DataFrame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div id="bf83cb8b" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="st">"price"</span>]        <span class="co"># -&gt; returns Series of shape (500,)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_pd[[<span class="st">"price"</span>]]      <span class="co"># -&gt; returns DataFrame of shape (500, 1)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df_pd.price           <span class="co"># -&gt; returns Series of shape (500,)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df_pd.loc[:, <span class="st">"price"</span>] <span class="co"># -&gt; returns Series of shape (500,)</span></span></code></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div id="408b487e" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="st">"price"</span>]                <span class="co"># -&gt; returns Series of shape (500,)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_pl[:, <span class="st">"price"</span>]             <span class="co"># -&gt; returns Series of shape (500,)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_pl.select(<span class="st">"price"</span>)         <span class="co"># -&gt; returns DataFrame of shape (500, 1)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>df_pl.select(pl.col(<span class="st">"price"</span>)) <span class="co"># -&gt; returns DataFrame of shape (500, 1)</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="select-multiple-columns-by-name" class="level4">
<h4 class="anchored" data-anchor-id="select-multiple-columns-by-name">Select multiple columns by name</h4>
<p>Below are several alternatives for selecting columns.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div id="9751ea55" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_pd[[<span class="st">"item"</span>, <span class="st">"price"</span>]]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_pd.loc[:, [<span class="st">"item"</span>, <span class="st">"price"</span>]]</span></code></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div id="97c9b488" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df_pl[[<span class="st">"item"</span>, <span class="st">"price"</span>]]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_pl[:, [<span class="st">"item"</span>, <span class="st">"price"</span>]]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="st">"item"</span>, <span class="st">"price"</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df_pl.select([<span class="st">"item"</span>, <span class="st">"price"</span>])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>df_pl.select(pl.col(<span class="st">"item"</span>, <span class="st">"price"</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="slice-columns-by-range" class="level4">
<h4 class="anchored" data-anchor-id="slice-columns-by-range">Slice columns by range</h4>
<p>Instead of selecting columns by name, we can write their positions in the DataFrame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div id="00342e8a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_pd.iloc[:, <span class="dv">5</span>:<span class="dv">7</span>]</span></code></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div id="4ecc36cb" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_pl[:, <span class="dv">5</span>:<span class="dv">7</span>]</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="slice-columns-by-name" class="level4">
<h4 class="anchored" data-anchor-id="slice-columns-by-name">Slice columns by name</h4>
<p>It’s also possible to select a range of columns by name. The resulting DataFrame will contain the first and the last selected column as well as any columns in-between.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div id="e6e33642" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_pd.loc[:, <span class="st">"in_stock"</span>:<span class="st">"found_in"</span>]</span></code></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div id="07187de0" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_pl[:, <span class="st">"in_stock"</span>:<span class="st">"found_in"</span>]</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="filter-columns-using-bools" class="level4">
<h4 class="anchored" data-anchor-id="filter-columns-using-bools">Filter columns using Bools</h4>
<p>We can pass a list of True/False values to select specific columns. The length of this list needs to be the same as the number of columns in the DataFrame. For instance, <code>df_pd</code>/<code>df_pl</code> contains 7 columns. Thus, one possible list of True/False values may look like this: <code>[True, False, True, False, True, True, True]</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div id="1bb9e477" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return all columns containing the substring "price"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_pd.loc[:, [<span class="st">"price"</span> <span class="kw">in</span> col <span class="cf">for</span> col <span class="kw">in</span> df_pd.columns]]</span></code></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div id="0a786108" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return all columns containing the substring "price"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_pl[:, [<span class="st">"price"</span> <span class="kw">in</span> col <span class="cf">for</span> col <span class="kw">in</span> df_pl.columns]]</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="rows" class="level3">
<h3 class="anchored" data-anchor-id="rows">Rows</h3>
<section id="select-row-by-index-label" class="level4">
<h4 class="anchored" data-anchor-id="select-row-by-index-label">Select row by index label</h4>
<p>In case the index is, for example, <code>datetime</code> or <code>str</code>, it is possible to select rows by the index label. However, this is not applicable in <code>polars</code> since <a href="https://docs.pola.rs/user-guide/migration/pandas/"><code>polars</code> treats the index differently</a> than <code>pandas</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div id="0fe19db7" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prices_pd <span class="op">=</span> prices_pd.set_index(<span class="st">"date"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>prices_pd.loc[<span class="st">"2025-01-05"</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>amulet     996.24
potion      49.65
cloak      497.42
staff     2643.03
scroll    1096.03
Name: 2025-01-05 00:00:00, dtype: float64</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div id="66f85b35" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Not applicable in polars</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is a call that outputs a similar result</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>prices_pl.<span class="bu">filter</span>(pl.col(<span class="st">"date"</span>) <span class="op">==</span> date(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">5</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<td>date</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025-01-05</td>
<td>996.24</td>
<td>49.65</td>
<td>497.42</td>
<td>2643.03</td>
<td>1096.03</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="select-a-single-row-by-integer-position" class="level4">
<h4 class="anchored" data-anchor-id="select-a-single-row-by-integer-position">Select a single row by integer position</h4>
<p>Both <code>pandas</code> and <code>polars</code> support selecting a single row using its integer position.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div id="60e030fe" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_pd.iloc[<span class="dv">4</span>] <span class="co"># -&gt; returns a Series</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="dv">4</span>:<span class="dv">5</span>]    <span class="co"># -&gt; returns a DataFrame</span></span></code></pre></div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div id="3ffef09b" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="dv">4</span>] </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="dv">4</span>:<span class="dv">5</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="dv">4</span>, :] <span class="co"># -&gt; all three of these return a DataFrame</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="slice-rows-by-integer-range" class="level4">
<h4 class="anchored" data-anchor-id="slice-rows-by-integer-range">Slice rows by integer range</h4>
<p>Likewise, both <code>pandas</code> and <code>polars</code> support selecting rows using a range of integers.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div id="f6e94632" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_pd.iloc[<span class="dv">0</span>:<span class="dv">5</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div id="59323fc9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="dv">0</span>:<span class="dv">5</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df_pl[<span class="dv">0</span>:<span class="dv">5</span>, :]</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="filter-rows-using-bools" class="level4">
<h4 class="anchored" data-anchor-id="filter-rows-using-bools">Filter rows using Bools</h4>
<p>We can pass a Series (or a similar object) containing True/False values to subset the DataFrame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div id="c020c2da" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get products with price over 1000</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df_pd[df_pd[<span class="st">"price"</span>] <span class="op">&gt;</span> <span class="dv">1000</span>]</span></code></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div id="650ba9bc" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get products with price over 1000</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>(df_pl[<span class="st">"price"</span>] <span class="op">&gt;</span> <span class="dv">1000</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>(pl.col(<span class="st">"price"</span>) <span class="op">&gt;</span> <span class="dv">1000</span>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="creating-new-columns" class="level2">
<h2 class="anchored" data-anchor-id="creating-new-columns">Creating new columns</h2>
<section id="new-empty-column" class="level4">
<h4 class="anchored" data-anchor-id="new-empty-column">New empty column</h4>
<p>Sometimes, it might make sense to create a new column in a DataFrame and fill it with NA values. I think of it as “reserving” the column for values that will be put into the column later. There are several ways to achieve this in both packages.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Missing values in <code>pandas</code>: depends on the datatype. Consider using <code>None</code> or <code>np.nan</code>. Note that <code>pd.NA</code> is <a href="https://pandas.pydata.org/docs/user_guide/missing_data.html#na-semantics">still experimental</a>.</p>
<div id="88036404" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Is any item in the wizard's shop cursed? We don't know =&gt; NA</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="st">"is_cursed"</span>] <span class="op">=</span> np.nan</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>df_pd <span class="op">=</span> df_pd.assign(is_cursed<span class="op">=</span>np.nan)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>df_pd <span class="op">=</span> df_pd.assign(<span class="op">**</span>{<span class="st">"is_cursed"</span>: np.nan})</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>df_pd.loc[:, <span class="st">"is_cursed"</span>] <span class="op">=</span> np.nan</span></code></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Missing values in <code>polars</code>: <code>None</code>, represented as <code>null</code>.</p>
<div id="8ee32f5e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Is any item in the wizard's shop cursed? We don't know =&gt; NA</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(is_cursed<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(is_cursed<span class="op">=</span>pl.lit(<span class="va">None</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(pl.lit(<span class="va">None</span>).alias(<span class="st">"is_cursed"</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="transform-an-existing-column" class="level4">
<h4 class="anchored" data-anchor-id="transform-an-existing-column">Transform an existing column</h4>
<p>Apply any function to an existing column in a DataFrame and write it as a new column.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Some options for transforming columns in <code>pandas</code>: <code>.transform()</code>, <code>.apply()</code>, calling a <code>numpy</code> function on the Series…</p>
<div id="fccdac10" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the logarithm of the price column</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="st">"log_price"</span>] <span class="op">=</span> df_pd[<span class="st">"price"</span>].transform(<span class="st">"log"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="st">"log_price"</span>] <span class="op">=</span> df_pd[<span class="st">"price"</span>].<span class="bu">apply</span>(np.log)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="st">"log_price"</span>] <span class="op">=</span> np.log(df_pd[<span class="st">"price"</span>])</span></code></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>Transforming columns in <code>polars</code>: use the <code>.with_columns(...)</code> method.</p>
<div id="b7746f26" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take the logarithm of the price column</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(pl.col(<span class="st">"price"</span>).log().alias(<span class="st">"log_price"</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(log_price<span class="op">=</span>pl.col(<span class="st">"price"</span>).log())</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(df_pl[<span class="st">"price"</span>].log().alias(<span class="st">"log_price"</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="boolean-filters" class="level2">
<h2 class="anchored" data-anchor-id="boolean-filters">Boolean filters</h2>
<p>Use set operations to filter the DataFrame based on predefined conditions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div id="b7e2e631" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AND operator</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df_pd[(df_pd[<span class="st">"price"</span>] <span class="op">&gt;</span> <span class="dv">500</span>) <span class="op">&amp;</span> (df_pd[<span class="st">"price"</span>] <span class="op">&lt;</span> <span class="dv">2000</span>)]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># OR operator</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>df_pd[(df_pd[<span class="st">"price"</span>] <span class="op">&gt;=</span> <span class="dv">500</span>) <span class="op">|</span> (df_pd[<span class="st">"item"</span>] <span class="op">!=</span> <span class="st">"scroll"</span>)]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="op">~</span>df_pd[<span class="st">"in_stock"</span>]]</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># True if a value matches any of the specified values, else False</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>df_pd[df_pd[<span class="st">"item"</span>].isin([<span class="st">"staff"</span>, <span class="st">"potion"</span>])]</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Is not NA... there's also .dropna() </span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="op">~</span>df_pd[<span class="st">"found_in"</span>].isna()]</span></code></pre></div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div id="a79ef4f9" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AND operator</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>((pl.col(<span class="st">"price"</span>) <span class="op">&gt;</span> <span class="dv">500</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"price"</span>) <span class="op">&lt;</span> <span class="dv">2000</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># OR operator</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>((pl.col(<span class="st">"price"</span>) <span class="op">&gt;=</span> <span class="dv">500</span>) <span class="op">|</span> (pl.col(<span class="st">"item"</span>) <span class="op">!=</span> <span class="st">"scroll"</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>(<span class="op">~</span>pl.col(<span class="st">"in_stock"</span>))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># True if a value matches any of the specified values, else False</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>(pl.col(<span class="st">"item"</span>).is_in([<span class="st">"staff"</span>, <span class="st">"potion"</span>]))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Is not NA... consider also .is_not_null()</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>df_pl.<span class="bu">filter</span>(<span class="op">~</span>pl.col(<span class="st">"found_in"</span>).is_null())</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="replacing-values-in-row-slices" class="level2">
<h2 class="anchored" data-anchor-id="replacing-values-in-row-slices">Replacing values in row slices</h2>
<p>Let me explain this with an example relating to the dataset at hand. We are looking at the inventory of a particular wizard shop. In this magical universe, let’s suppose that we learn that every item with <code>magical_power</code> over 900 is cursed. There might be other reasons why an item is cursed, but these reasons are unknown to us.</p>
<p>What we can do is to filter the DataFrame to display only items with <code>magical_power</code> over 900 and using this filter, we write <code>True</code> to the <code>is_cursed</code> column for every row satisfying this condition.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>Label all items with <code>magical_power</code> over 900 as cursed.</p>
<div id="9e5dd64d" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A column full of NAs should be cast as "object" first</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df_pd[<span class="st">"is_cursed"</span>] <span class="op">=</span> df_pd[<span class="st">"is_cursed"</span>].astype(<span class="st">"object"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>df_pd.loc[df_pd[<span class="st">"magical_power"</span>] <span class="op">&gt;</span> <span class="dv">900</span>, <span class="st">"is_cursed"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>df_pd.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">magical_power</th>
<th data-quarto-table-cell-role="th">quality</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">found_in</th>
<th data-quarto-table-cell-role="th">is_cursed</th>
<th data-quarto-table-cell-role="th">log_price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>amulet</td>
<td>915.0</td>
<td>402.961</td>
<td>9</td>
<td>True</td>
<td>dungeon</td>
<td>NaN</td>
<td>6.818924</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>staff</td>
<td>2550.0</td>
<td>933.978</td>
<td>2</td>
<td>False</td>
<td>dungeon</td>
<td>True</td>
<td>7.843849</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>potion</td>
<td>62.2</td>
<td>129.897</td>
<td>5</td>
<td>True</td>
<td>city</td>
<td>NaN</td>
<td>4.130355</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>Label all items with <code>magical_power</code> over 900 as cursed.</p>
<div id="dd3c7ba5" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_pl <span class="op">=</span> df_pl.with_columns(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    pl.when(pl.col(<span class="st">"magical_power"</span>) <span class="op">&gt;</span> <span class="dv">900</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    .then(pl.lit(<span class="va">True</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.col(<span class="st">"is_cursed"</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    .alias(<span class="st">"is_cursed"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>df_pl.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 9)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">magical_power</th>
<th data-quarto-table-cell-role="th">quality</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">found_in</th>
<th data-quarto-table-cell-role="th">is_cursed</th>
<th data-quarto-table-cell-role="th">log_price</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>bool</td>
<td>str</td>
<td>bool</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"amulet"</td>
<td>915.0</td>
<td>402.961</td>
<td>9</td>
<td>true</td>
<td>"dungeon"</td>
<td>null</td>
<td>6.818924</td>
</tr>
<tr class="even">
<td>2</td>
<td>"staff"</td>
<td>2550.0</td>
<td>933.978</td>
<td>2</td>
<td>false</td>
<td>"dungeon"</td>
<td>true</td>
<td>7.843849</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"potion"</td>
<td>62.2</td>
<td>129.897</td>
<td>5</td>
<td>true</td>
<td>"city"</td>
<td>null</td>
<td>4.130355</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="create-a-copy" class="level2">
<h2 class="anchored" data-anchor-id="create-a-copy">Create a copy</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div id="de61bd5f" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_pd_temp <span class="op">=</span> df_pd.copy()</span></code></pre></div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>In <code>polars</code>, copying or <em>cloning</em> (<code>.clone()</code> method) may not be necessary.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div id="5afa439c" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_pl_temp <span class="op">=</span> df_pl</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="joining-data" class="level2">
<h2 class="anchored" data-anchor-id="joining-data">Joining data</h2>
<section id="inner-join" class="level3">
<h3 class="anchored" data-anchor-id="inner-join">Inner join</h3>
<p>The <code>info_pd</code> / <code>info_pl</code> table contains typical information (e.g., typical price) about each item in the fantasy universe this dataset was sourced from. Naturally, the shopkeeper has no incentive to provide this information in the original data. However, we can add the information from the info table to the main table ourselves.</p>
<p>In our case, we can use an “inner join” and match the items using the <code>item</code> column as long as</p>
<ul>
<li><p>both tables contain this column,</p></li>
<li><p>and the column itself serves the same purpose in both tables.</p></li>
</ul>
<p>If there would be an additional item in the shopkeeper’s inventory for which we wouldn’t have data in the <code>info</code> table, we may consider using an “outer join.” For a review of joins consider reading the following <a href="https://en.wikipedia.org/wiki/Join_(SQL)">Wiki article</a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div id="df61714e" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>info_pd</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">typical_price</th>
<th data-quarto-table-cell-role="th">typical_quality</th>
<th data-quarto-table-cell-role="th">typically_found_in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>amulet</td>
<td>1000</td>
<td>9</td>
<td>dungeon</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>potion</td>
<td>50</td>
<td>7</td>
<td>village</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>cloak</td>
<td>500</td>
<td>4</td>
<td>city</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>staff</td>
<td>2000</td>
<td>5</td>
<td>dungeon</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>scroll</td>
<td>900</td>
<td>2</td>
<td>dungeon</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1abb3d2d" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_full_pd <span class="op">=</span> pd.merge(left<span class="op">=</span>df_pd, right<span class="op">=</span>info_pd, how<span class="op">=</span><span class="st">"inner"</span>, on<span class="op">=</span><span class="st">"item"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df_full_pd.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">magical_power</th>
<th data-quarto-table-cell-role="th">quality</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">found_in</th>
<th data-quarto-table-cell-role="th">is_cursed</th>
<th data-quarto-table-cell-role="th">log_price</th>
<th data-quarto-table-cell-role="th">typical_price</th>
<th data-quarto-table-cell-role="th">typical_quality</th>
<th data-quarto-table-cell-role="th">typically_found_in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>amulet</td>
<td>915.0</td>
<td>402.961</td>
<td>9</td>
<td>True</td>
<td>dungeon</td>
<td>NaN</td>
<td>6.818924</td>
<td>1000</td>
<td>9</td>
<td>dungeon</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>staff</td>
<td>2550.0</td>
<td>933.978</td>
<td>2</td>
<td>False</td>
<td>dungeon</td>
<td>True</td>
<td>7.843849</td>
<td>2000</td>
<td>5</td>
<td>dungeon</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>potion</td>
<td>62.2</td>
<td>129.897</td>
<td>5</td>
<td>True</td>
<td>city</td>
<td>NaN</td>
<td>4.130355</td>
<td>50</td>
<td>7</td>
<td>village</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div id="0f2793cc" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>info_pl</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">typical_price</th>
<th data-quarto-table-cell-role="th">typical_quality</th>
<th data-quarto-table-cell-role="th">typically_found_in</th>
</tr>
<tr class="even">
<td>str</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"amulet"</td>
<td>1000</td>
<td>9</td>
<td>"dungeon"</td>
</tr>
<tr class="even">
<td>"potion"</td>
<td>50</td>
<td>7</td>
<td>"village"</td>
</tr>
<tr class="odd">
<td>"cloak"</td>
<td>500</td>
<td>4</td>
<td>"city"</td>
</tr>
<tr class="even">
<td>"staff"</td>
<td>2000</td>
<td>5</td>
<td>"dungeon"</td>
</tr>
<tr class="odd">
<td>"scroll"</td>
<td>900</td>
<td>2</td>
<td>"dungeon"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="2dfce4ac" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_full_pl <span class="op">=</span> df_pl.join(other<span class="op">=</span>info_pl, on<span class="op">=</span><span class="st">"item"</span>, how<span class="op">=</span><span class="st">"inner"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>df_full_pl.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">item</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">magical_power</th>
<th data-quarto-table-cell-role="th">quality</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">found_in</th>
<th data-quarto-table-cell-role="th">is_cursed</th>
<th data-quarto-table-cell-role="th">log_price</th>
<th data-quarto-table-cell-role="th">typical_price</th>
<th data-quarto-table-cell-role="th">typical_quality</th>
<th data-quarto-table-cell-role="th">typically_found_in</th>
</tr>
<tr class="even">
<td>i64</td>
<td>str</td>
<td>f64</td>
<td>f64</td>
<td>i64</td>
<td>bool</td>
<td>str</td>
<td>bool</td>
<td>f64</td>
<td>i64</td>
<td>i64</td>
<td>str</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>"amulet"</td>
<td>915.0</td>
<td>402.961</td>
<td>9</td>
<td>true</td>
<td>"dungeon"</td>
<td>null</td>
<td>6.818924</td>
<td>1000</td>
<td>9</td>
<td>"dungeon"</td>
</tr>
<tr class="even">
<td>2</td>
<td>"staff"</td>
<td>2550.0</td>
<td>933.978</td>
<td>2</td>
<td>false</td>
<td>"dungeon"</td>
<td>true</td>
<td>7.843849</td>
<td>2000</td>
<td>5</td>
<td>"dungeon"</td>
</tr>
<tr class="odd">
<td>3</td>
<td>"potion"</td>
<td>62.2</td>
<td>129.897</td>
<td>5</td>
<td>true</td>
<td>"city"</td>
<td>null</td>
<td>4.130355</td>
<td>50</td>
<td>7</td>
<td>"village"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="concatenate-by-rows" class="level3">
<h3 class="anchored" data-anchor-id="concatenate-by-rows">Concatenate by rows</h3>
<p>Concatenating by rows stacks two tables on top of each other like bricks.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div id="36862fc8" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>new_price <span class="op">=</span> pd.DataFrame(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"amulet"</span>: [<span class="fl">1005.1</span>],</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"potion"</span>: [<span class="fl">55.32</span>],</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cloak"</span>: [<span class="fl">550.06</span>],</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"staff"</span>: [<span class="fl">1500.15</span>],</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"scroll"</span>: [<span class="fl">1123.06</span>]</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[datetime(<span class="dv">2026</span>, <span class="dv">1</span>, <span class="dv">1</span>)]</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>pd.concat([prices_pd, new_price]).tail(<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2025-12-31</th>
<td>957.94</td>
<td>64.08</td>
<td>503.88</td>
<td>2899.72</td>
<td>829.59</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2026-01-01</th>
<td>1005.10</td>
<td>55.32</td>
<td>550.06</td>
<td>1500.15</td>
<td>1123.06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div id="5e36f195" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>new_price <span class="op">=</span> pl.DataFrame({</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"date"</span>: date(<span class="dv">2026</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"amulet"</span>: <span class="fl">1005.1</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"potion"</span>: <span class="fl">55.32</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cloak"</span>: <span class="fl">550.06</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"staff"</span>: <span class="fl">1500.15</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"scroll"</span>: <span class="fl">1123.06</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>pl.concat([prices_pl, new_price]).tail(<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<td>date</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025-12-31</td>
<td>957.94</td>
<td>64.08</td>
<td>503.88</td>
<td>2899.72</td>
<td>829.59</td>
</tr>
<tr class="even">
<td>2026-01-01</td>
<td>1005.1</td>
<td>55.32</td>
<td>550.06</td>
<td>1500.15</td>
<td>1123.06</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="quick-plotting" class="level2">
<h2 class="anchored" data-anchor-id="quick-plotting">Quick plotting</h2>
<p>DataFrames in <code>pandas</code> can be quickly plotted using the <code>.plot()</code> method. While <code>polars</code> also contains quick plotting capabilities, I prefer converting the DataFrame to <code>pandas</code>. For more complex plots, consider using <code>seaborn</code>, <code>bokeh</code>, <code>plotly</code>, <code>altair</code>, or any other data visualization library.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p>Display the mean quality of the shopkeeper’s items vs the typical quality of each item.</p>
<div id="e7c7bf29" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>quality_pd <span class="op">=</span> df_full_pd[[<span class="st">"item"</span>, <span class="st">"quality"</span>, <span class="st">"typical_quality"</span>]]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>quality_pd.groupby(<span class="st">"item"</span>).mean().plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-45-output-1.png" width="558" height="463" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<p>Display the mean quality of the shopkeeper’s items vs the typical quality of each item.</p>
<div id="90b44648" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>quality_pl <span class="op">=</span> df_full_pl.to_pandas()[[<span class="st">"item"</span>, <span class="st">"quality"</span>, <span class="st">"typical_quality"</span>]]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>quality_pl.groupby(<span class="st">"item"</span>).mean().plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-46-output-1.png" width="558" height="463" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Similar plot in polars via Altair (not displayed)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    df_full_pl.group_by(<span class="st">"item"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    .select(<span class="st">"item"</span>, <span class="st">"quality"</span>, <span class="st">"typical_quality"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    .unpivot(index<span class="op">=</span><span class="st">"item"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    .plot.bar(x<span class="op">=</span><span class="st">"item"</span>, y<span class="op">=</span><span class="st">"value"</span>, color<span class="op">=</span><span class="st">"variable"</span>, column<span class="op">=</span><span class="st">"variable"</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
</section>
<section id="dates" class="level2">
<h2 class="anchored" data-anchor-id="dates">Dates</h2>
<section id="create-a-range-of-dates" class="level3">
<h3 class="anchored" data-anchor-id="create-a-range-of-dates">Create a range of dates</h3>
<p>The <code>pandas</code> package is great for time series data. It offers valuable functions like <code>date_range()</code> or <code>to_datetime()</code>. <code>polars</code> also has special capabilities for handling time series data, though it seems to me that it expects the user to utilize the <code>datetime</code> module more than <code>pandas</code>.</p>
<p>Another difference is that <code>polars</code> may return an expression instead of the actual Series of dates by default. This is why you’ll see me using <code>eager=True</code> to get a Series instead of an expression.</p>
<p>Let’s take a look at some of the basic operations with dates.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<p>Make a range of dates from a specific date (and time) to a specific date (and time).</p>
<div id="e4234b30" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pd.date_range(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    start<span class="op">=</span><span class="st">"2025-01-01 00:00"</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    end<span class="op">=</span><span class="st">"2025-01-01 23:00"</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    freq<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    tz<span class="op">=</span><span class="st">"Europe/Prague"</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<p>Make a range of dates from a specific date (and time) to a specific date (and time).</p>
<div id="34956d27" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pl.datetime_range(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    start<span class="op">=</span>datetime(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    end<span class="op">=</span>datetime(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">23</span>, <span class="dv">0</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    interval<span class="op">=</span><span class="st">"1h"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    eager<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    time_zone<span class="op">=</span><span class="st">"Europe/Prague"</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative start/end: datetime.fromisoformat("2025-01-01 00:00")</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p>Create a date range with a specific number of periods. For instance, start at <code>2025-01-01</code> and continue 100 days into the future.</p>
<div id="3deea3ed" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>out_periods <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>pd.date_range(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    start<span class="op">=</span><span class="st">"2025-01-01"</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    periods<span class="op">=</span>out_periods, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    freq<span class="op">=</span><span class="st">"d"</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<p>Create a date range with a specific number of periods. For instance, start at <code>2025-01-01</code> and continue 100 days into the future.</p>
<div id="ab463579" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>out_periods <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>pl.date_range(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    start<span class="op">=</span>date(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    end<span class="op">=</span>date(<span class="dv">2025</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="op">+</span> timedelta(days<span class="op">=</span>out_periods <span class="op">-</span> <span class="dv">1</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    interval<span class="op">=</span><span class="st">"1d"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Returns a Series if True, otherwise returns an expression</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    eager<span class="op">=</span><span class="va">True</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="subset-a-specific-time-interval" class="level3">
<h3 class="anchored" data-anchor-id="subset-a-specific-time-interval">Subset a specific time interval</h3>
<p>Suppose we want to take a look at February data in our price table.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div id="729b1b89" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices in February</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>prices_pd[prices_pd.index.month <span class="op">==</span> <span class="dv">2</span>].head()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2025-02-01</th>
<td>1200.15</td>
<td>45.70</td>
<td>441.72</td>
<td>1315.41</td>
<td>604.27</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2025-02-02</th>
<td>828.88</td>
<td>55.32</td>
<td>526.56</td>
<td>1591.24</td>
<td>628.25</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2025-02-03</th>
<td>774.96</td>
<td>47.35</td>
<td>515.86</td>
<td>1924.56</td>
<td>969.40</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2025-02-04</th>
<td>842.21</td>
<td>53.05</td>
<td>522.74</td>
<td>2305.17</td>
<td>991.64</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2025-02-05</th>
<td>1147.03</td>
<td>53.27</td>
<td>583.07</td>
<td>2222.09</td>
<td>1529.96</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div id="7de73b32" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prices in February</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>prices_pl.<span class="bu">filter</span>(pl.col(<span class="st">"date"</span>).dt.month() <span class="op">==</span> <span class="dv">2</span>).head()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<td>date</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025-02-01</td>
<td>1200.15</td>
<td>45.7</td>
<td>441.72</td>
<td>1315.41</td>
<td>604.27</td>
</tr>
<tr class="even">
<td>2025-02-02</td>
<td>828.88</td>
<td>55.32</td>
<td>526.56</td>
<td>1591.24</td>
<td>628.25</td>
</tr>
<tr class="odd">
<td>2025-02-03</td>
<td>774.96</td>
<td>47.35</td>
<td>515.86</td>
<td>1924.56</td>
<td>969.4</td>
</tr>
<tr class="even">
<td>2025-02-04</td>
<td>842.21</td>
<td>53.05</td>
<td>522.74</td>
<td>2305.17</td>
<td>991.64</td>
</tr>
<tr class="odd">
<td>2025-02-05</td>
<td>1147.03</td>
<td>53.27</td>
<td>583.07</td>
<td>2222.09</td>
<td>1529.96</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="resampling" class="level3">
<h3 class="anchored" data-anchor-id="resampling">Resampling</h3>
<p>In time series analysis, we often need to change the frequency of our data. For instance, if we have daily data, we may want to look at monthly averages, yearly max values, and so on.</p>
<p>Conversely, suppose we want to join a daily and an hourly dataset. In this case, we may need to convert the daily time series to hourly. We can do this by, for example, repeating the daily value for each hour or by using interpolation.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div id="24daf702" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly mean from daily data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>prices_pd.resample(<span class="st">"ME"</span>).mean()</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Upsample daily data to hourly by repeating values</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>prices_pd.resample(<span class="st">"h"</span>).ffill()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Upsample daily data to hourly by interpolating (linearly)</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>prices_pd.resample(<span class="st">"h"</span>).interpolate(<span class="st">"linear"</span>)</span></code></pre></div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div id="c51f6d27" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly mean from daily data</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>prices_pl.group_by_dynamic(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    index_column<span class="op">=</span><span class="st">"date"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    every<span class="op">=</span><span class="st">"1mo"</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>).agg(pl.selectors.numeric().mean())</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Upsample daily data to hourly by repeating values</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>prices_pl.upsample(</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    time_column<span class="op">=</span><span class="st">"date"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    every<span class="op">=</span><span class="st">"1h"</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>).select(pl.<span class="bu">all</span>().forward_fill())</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Upsample daily data to hourly by interpolating (linearly)</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>prices_pl.upsample(</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    time_column<span class="op">=</span><span class="st">"date"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    every<span class="op">=</span><span class="st">"1h"</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>).interpolate()</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="group-by-time-intervals" class="level3">
<h3 class="anchored" data-anchor-id="group-by-time-intervals">Group by time intervals</h3>
<p>We can also group data by specific time intervals. For instance, we can calculate the median price of each item in 3-month windows.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div id="ed8c46bd" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>prices_pd.groupby(pd.Grouper(freq<span class="op">=</span><span class="st">"3MS"</span>)).median()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2025-01-01</th>
<td>973.755</td>
<td>49.995</td>
<td>503.050</td>
<td>2043.170</td>
<td>966.495</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2025-04-01</th>
<td>990.040</td>
<td>49.340</td>
<td>505.000</td>
<td>1931.890</td>
<td>870.100</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2025-07-01</th>
<td>1051.605</td>
<td>50.345</td>
<td>499.150</td>
<td>2005.865</td>
<td>850.470</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2025-10-01</th>
<td>991.855</td>
<td>49.620</td>
<td>509.435</td>
<td>1997.755</td>
<td>851.620</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<p>Some people (<a href="https://docs.pola.rs/user-guide/misc/styling/#full-example">example</a> in the official docs) format longer <code>polars</code> code like this:</p>
<div id="a6356051" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    prices_pl</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    .group_by_dynamic(index_column<span class="op">=</span><span class="st">"date"</span>, every<span class="op">=</span><span class="st">"3mo"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    .agg(pl.selectors.numeric().median())</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">amulet</th>
<th data-quarto-table-cell-role="th">potion</th>
<th data-quarto-table-cell-role="th">cloak</th>
<th data-quarto-table-cell-role="th">staff</th>
<th data-quarto-table-cell-role="th">scroll</th>
</tr>
<tr class="even">
<td>date</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
<td>f64</td>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2025-01-01</td>
<td>973.755</td>
<td>49.995</td>
<td>503.05</td>
<td>2043.17</td>
<td>966.495</td>
</tr>
<tr class="even">
<td>2025-04-01</td>
<td>990.04</td>
<td>49.34</td>
<td>505.0</td>
<td>1931.89</td>
<td>870.1</td>
</tr>
<tr class="odd">
<td>2025-07-01</td>
<td>1051.605</td>
<td>50.345</td>
<td>499.15</td>
<td>2005.865</td>
<td>850.47</td>
</tr>
<tr class="even">
<td>2025-10-01</td>
<td>991.855</td>
<td>49.62</td>
<td>509.435</td>
<td>1997.755</td>
<td>851.62</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="saving-data" class="level2">
<h2 class="anchored" data-anchor-id="saving-data">Saving data</h2>
<p>Both packages support a large number of output formats and the syntax is similar.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true" href="">1️⃣ pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false" href="">2️⃣ polars</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_pd.to_csv(<span class="st">"file.csv"</span>)</span></code></pre></div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df_pl.write_csv(<span class="st">"file.csv"</span>)</span></code></pre></div>
</div>
</div>
</div>
</section>
<section id="sources-and-further-reading" class="level2">
<h2 class="anchored" data-anchor-id="sources-and-further-reading">Sources and further reading</h2>
<p>This guide is mainly based on information from</p>
<ul>
<li><a href="https://docs.pola.rs/" class="uri">https://docs.pola.rs/</a></li>
<li><a href="https://pandas.pydata.org/docs/" class="uri">https://pandas.pydata.org/docs/</a></li>
</ul>
<p>It’s also loosely inspired by Keith Galli’s incredible <code>pandas</code> tutorial on YouTube</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=vmEHCJofslg" class="uri">https://www.youtube.com/watch?v=vmEHCJofslg</a></li>
</ul>
<p>Let me also mention a neat cheat sheet on going from <code>pandas</code> to <code>polars</code> on Rho Signal</p>
<ul>
<li><a href="https://www.rhosignal.com/posts/polars-pandas-cheatsheet/" class="uri">https://www.rhosignal.com/posts/polars-pandas-cheatsheet/</a></li>
</ul>
<p>Finally, for more advanced and extensive coverage of <code>polars</code> x <code>pandas</code>, I would highly recommend “Modern Polars”</p>
<ul>
<li><a href="https://kevinheavey.github.io/modern-polars/" class="uri">https://kevinheavey.github.io/modern-polars/</a></li>
</ul>
<p><br> <a href="https://github.com/rnd195/rnd195.github.io-comments/issues/3" class="btn btn-secondary bi-chat" title="Comment on GitHub" target="_blank">Comment on GitHub</a></p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>For stylistic purposes, let me refer to the Polars package as <code>polars</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>33.4k stars in early May 2025 <a href="https://github.com/pola-rs/polars" class="uri">https://github.com/pola-rs/polars</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>JetBrains (2023). “What is Polars?” on YouTube. <a href="https://www.youtube.com/watch?v=QfLzEp-yt_U" class="uri">https://www.youtube.com/watch?v=QfLzEp-yt_U</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>See <a href="https://github.com/rnd195/wizard-shop-dataset" class="uri">https://github.com/rnd195/wizard-shop-dataset</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>See <a href="https://stackoverflow.com/a/78136839" class="uri">https://stackoverflow.com/a/78136839</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>Content of this blogpost is licensed under Creative Commons Attribution CC BY 4.0. Any content used from other sources is indicated and is  not covered by this license.
<a rel="license" href="https://creativecommons.org/licenses/by/4.0/">(View License)</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/rnd195\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://github.com/rnd195/rnd195.github.io/">
<p>2025 rnd195</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../privacy.html">
<p>Privacy policy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://quarto.org/" target="_blank">
<p>Made with Quarto</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>